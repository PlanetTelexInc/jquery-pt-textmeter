/*
 * Copyright (c) 2012 Planet Telex Inc. all rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function(a){a.fn.textmeter=function(b,c){b=b||140;
    c = a.extend({ container: "<span></span>", className: "textmeter", format: "<br/>Characters left: <strong>{n}</strong>", pulse: true, delay: 0, ignoreRegex: null, ignoreReplacementSize: 0 }, c);
var g,f;
function e(i,h){i=a(i);
var j=i.val().length;
if(c.ignoreRegex!=null&&c.ignoreRegex.test(i.val())){j=i.val().replace(c.ignoreRegex,"").length+c.ignoreReplacementSize
}if(j>b){if(c.pulse&&!g){d(h,true)
}}if(c.delay>0){if(f){window.clearTimeout(f)
}f=window.setTimeout(function(){h.html(c.format.replace("{n}",(b-j)))
},c.delay)
}else{h.html(c.format.replace("{n}",(b-j)))
}}function d(h,i){if(g){window.clearTimeout(g);
g=null
}h.animate({opacity:0.1},100,function(){a(this).animate({opacity:1},100)
});
if(i){g=window.setTimeout(function(){d(h)
},200)
}}return this.each(function(){var h=(!c.container.match(/^<.+>$/))?a(c.container):a(c.container).insertAfter(this).addClass(c.className);
a(this).bind("keydown",function(){e(this,h)
}).bind("keypress",function(){e(this,h)
}).bind("keyup",function(){e(this,h)
}).bind("focus",function(){e(this,h)
}).bind("mouseover",function(){e(this,h)
}).bind("mouseout",function(){e(this,h)
}).bind("paste",function(){var i=this;
setTimeout(function(){e(i,h)
},10)
});
if(this.addEventListener){this.addEventListener("input",function(){e(this,h)
},false)
}e(this,h)
})
}
})(jQuery);